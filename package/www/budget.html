<html lang="en">
<head><script src="deployment.js"></script>
  <title>Community Finances</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
  <script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>

  <script type="text/javascript" src="cc.js"></script>
  <script type="text/javascript">
	window.onload = function () {
	var budget = communityCurrency.getBudget();
		var goalDemurrage = budget[0];
		var goalCrowdFundig = budget[1];
		var goalCommunityHours = budget[2];
		var goalExpenses = budget[3];
		var committedCrowdFundig = budget[4];
		var committedCommunityHours = budget[5];
		var committedExpenses = budget[6];
		var realDemurrage = budget[7];
		var realCrowdFundig = budget[8];
		var realCommunityHours = budget[9];
		var realExpenses = budget[10];
		var communeBalance = budget[11];
		var treasuryBalance = budget[12];
		
	var MoneyTotals = communityCurrency.getMoneyTotals();
		var totalMinted = MoneyTotals[0];
		var totalCredit = MoneyTotals[1];
		var totalTrustCost = MoneyTotals[2];
		var totalTrustAvailable = MoneyTotals[3];

		var credits = communityCurrency.Credit({fromBlock: 0, toBlock: 'latest'});
			var row = "";
			credits.watch(function(error, result){
			row += Date(result.args.__cDealine) + "&emsp;" + result.args._moneyLender + "&emsp;<span class=\"badge\">" + result.args._endorsedUoT + " UoT</span><br/>";
			document.getElementById('listCredit').innerHTML = row;
			});
		
		var creditsExp = communityCurrency.CreditExp({fromBlock: 0, toBlock: 'latest'});
			var row = "";
			creditsExp.watch(function(error, result){
			row += Date(result.args._timeStampCX) + "&emsp;" + result.args._oldMoneyLender + "&emsp;<span class=\"badge\">" + result.args._oldUoT + " UoT</span> success <span class=\"badge\">" + result.args._success +  "<span><br/>";
			document.getElementById('listCreditEx').innerHTML = row;
			});

	document.getElementById('me').innerHTML = "alias: " + myAlias + "<br/> account: " + coinbase;
	document.getElementById('goalDemurrage').innerText = goalDemurrage/baseUnits + " HR";
	document.getElementById('goalCrowdFundig').innerText = goalCrowdFundig/baseUnits + " HR";
	document.getElementById('goalCommunityHours').innerText = goalCommunityHours/baseUnits + " HR";
	document.getElementById('goalExpenses').innerText = goalExpenses/baseUnits + " HR";
	document.getElementById('committedCrowdFundig').innerText = committedCrowdFundig/baseUnits + " HR";
	document.getElementById('committedCommunityHours').innerText = committedCommunityHours/baseUnits + " HR";
	document.getElementById('committedExpenses').innerText = committedExpenses/baseUnits + " HR";
	document.getElementById('realDemurrage').innerText = realDemurrage/baseUnits + " HR";
	document.getElementById('realCrowdFundig').innerText = realCrowdFundig/baseUnits + " HR";
	document.getElementById('realCommunityHours').innerText = realCommunityHours/baseUnits + " HR";
	document.getElementById('realExpenses').innerText = realExpenses/baseUnits + " HR";
	document.getElementById('goalITotal').innerText = (Number(goalDemurrage) + Number(goalCrowdFundig))/baseUnits + " HR";
	document.getElementById('committedITotal').innerText = committedCrowdFundig/baseUnits + " HR";
	document.getElementById('realITotal').innerText = (Number(realDemurrage) + Number(realCrowdFundig))/baseUnits + " HR";
	document.getElementById('goalETotal').innerText = (Number(goalCommunityHours) + Number(goalExpenses))/baseUnits + " HR";
	document.getElementById('committedETotal').innerText = (Number(committedCommunityHours) + Number(committedExpenses))/baseUnits + " HR";
	document.getElementById('realETotal').innerText = (Number(realCommunityHours) + Number(realExpenses))/baseUnits + " HR";
	document.getElementById('communeBalance').innerText = communeBalance/baseUnits + " HR";
	document.getElementById('treasuryBalance').innerText = treasuryBalance/baseUnits + " HR";
	document.getElementById('totalMinted').innerText = totalMinted/baseUnits + " HR";
	document.getElementById('totalCreditEndorsed').innerText = totalCredit/baseUnits + " HR";
	document.getElementById('totalMonetaryMass').innerText = (Number(totalMinted) + Number(totalCredit))/baseUnits + " HR";
	document.getElementById('totalTrustUsed').innerText = totalTrustCost/baseUnits + " UoT";
	document.getElementById('totalTrustAvailable').innerText = totalTrustAvailable/baseUnits + " UoT";
	document.getElementById('totalTrustMass').innerText = (Number(totalTrustCost) + Number(totalTrustAvailable))/baseUnits + " UoT";
	document.getElementById('demurrage').innerText = demurrage + " %";
	document.getElementById('rewardRate').innerText = rewardRate + " %";
	document.getElementById('iniMemberCCUs').innerText = iniMemberCCUs/baseUnits + " HR";
	document.getElementById('iniMemberReputation').innerText = iniMemberReputation/baseUnits + " UoT";
	document.getElementById('exchange').innerText = exchangeRate + " EUR/HR";
	}
	</script>
    <style>
     .navbar {
      margin-bottom: 0;
      border-radius: 0;
    }
  </style>
</head>
<body>

<script type="text/javascript" src="navbar.js"></script>

<div class="container bg-3 text-center">  
  <div class="col-sm-8"> 
    <small><p id="me"></p></small>  
	<h3><span class="glyphicon glyphicon-th-list"></span> Commons Finances</h3>
		<div class="alert alert-warning">
			<small>This page only available to the Commoners</small>
		</div>
	<h4><span class="glyphicon glyphicon-th-list"></span> Commune Rolling Budget</h4>  
    <table class="table table-bordered">
    <thead>
      <tr>
        <th>Concept</th>
        <th>Goal</th>     
        <th>Committed</th>                
        <th>Actual</th>
      </tr>
    </thead>
    <tbody>
			<tr>
				<td><b>Incomes</b></td>
				<td>Goal</td>
				<td>Committed</td>
				<td>Received</td>
			</tr>
			<tr>
				<td>Demurrage</td>
				<td><output class="form-control" id="goalDemurrage"></output></td>
				<td></td>
				<td><output class="form-control" id="realDemurrage"></output></td>
			</tr>
			<tr>
				<td>Crowd-funding</td>
				<td><output class="form-control" id="goalCrowdFundig"></output></td>
				<td><output class="form-control" id="committedCrowdFundig"></output></td>
				<td><output class="form-control" id="realCrowdFundig"></output></td>
			</tr>
			<tr>
				<td><b><i>total</i></b></td>
				<td><output class="form-control" id="goalITotal"></output></td>
				<td><output class="form-control" id="committedITotal"></output></td>
				<td><output class="form-control" id="realITotal"></output></td>
			</tr>
			<tr>
				<td><b>Payments</b></td>
				<td>Goal</td>
				<td>Committed</td>
				<td>Paid</td>

			</tr>
			<tr>
				<td>Community Services</td>
				<td><output class="form-control" id="goalCommunityHours"></output></td>
				<td><output class="form-control" id="committedCommunityHours"></output></td>
				<td><output class="form-control" id="realCommunityHours"></output></td>
			</tr>
			<tr>
				<td>Other Expenses</td>
				<td><output class="form-control" id="goalExpenses"></output></td>
				<td><output class="form-control" id="committedExpenses"></output></td>
				<td><output class="form-control" id="realExpenses"></output></td>
			</tr>
			<tr>
				<td><b><i>total</i></b></td>
				<td><output class="form-control" id="goalETotal"></output></td>
				<td><output class="form-control" id="committedETotal"></output></td>
				<td><output class="form-control" id="realETotal"></output></td>
		</tr>
      </tbody>
     </table>
 
 	<h4><span class="glyphicon glyphicon-piggy-bank"></span> Commons Wallets</h4>      
    <table class="table table-bordered">
    <thead>
      <tr>
        <th>Wallet</th>
        <th>balance</th>                
      </tr>
    </thead>
    <tbody>
			<tr>
				<td>Commune Wallet</td>
				<td><output class="form-control" id="communeBalance"></output></td>

			</tr>
			<tr>
				<td>Treasury Wallet</td>
				<td><output class="form-control" id="treasuryBalance"></output></td>
			</tr>
	</tbody>
	</table>
     
	<h4><span class="glyphicon glyphicon-hourglass"></span> Monetary Mass</h4>  
	<table class="table table-bordered">
    <thead>
      <tr>
        <th>Monetary Mass</th>
        <th></th>
      </tr>
    </thead>
    <tbody>
      <tr><td>Total Minted</td><td align="right"><output class="form-control" id="totalMinted"></output></td>
      <tr><td>Total Credit endorsed</td><td align="right"><output class="form-control" id="totalCreditEndorsed"></output></td>      
      <tr><td><b>Total Monetary Mass</b></td><td align="right"><output class="form-control" id="totalMonetaryMass"></output></td>
     </tbody>
     </table>
     
	<h4><span class="glyphicon glyphicon-heart"></span> Reputation Mass</h3>       
	<table class="table table-bordered">
    <thead>
      <tr>
        <th>Reputation Mass</th>
        <th></th>
      </tr>
    </thead>
    <tbody>
      <tr><td>Total Trust used</td><td align="right"><output class="form-control" id="totalTrustUsed"></output></td>
      <tr><td>Total Trust available</td><td align="right"><output class="form-control" id="totalTrustAvailable"></output></td>
      <tr><td><b>Total Reputation Mass</b></td><td align="right"><output class="form-control" id="totalTrustMass"></output></td>
     </tbody>
     </table>
     
  
  <h4><span class="glyphicon glyphicon-wrench"></span> Currency Parameters</h4>
     <form role="form">
		  <div class="form-group">
		    <label for="demurrage">Demurrage Rate in %:</label>
			<output type="text" class="form-control" id="demurrage"></output>
		  </div>
		  <div class="form-group">
		    <label for="rewardRate">Money Lenders Reward Rate in %:</label>
		    <output type="text" class="form-control" id="rewardRate"></output>
		  </div>
		  <div class="form-group">
		    <label for="iniMemberCCUs">Members Initial Amount in HR:</label>
		    <output type="text" class="form-control" id="iniMemberCCUs"></output>
		  </div>
		  <div class="form-group">
		    <label for="iniMemberReputation">Members Initial Reputation in UoT:</label>
		    <output type="text" class="form-control" id="iniMemberReputation"></output>
		  </div>
		  <div class="form-group">
		    <label for="exchange">Exchange Rate:</label>
		    <output type="text" class="form-control" id="exchange"></output>
		  </div>
		</form>

	<h4><span class="glyphicon glyphicon-thumbs-up"></span> Credits</h4>
	<h4><span class="glyphicon glyphicon-ok"></span> Endorsed Credits by Authorizer</h4> 
		<div  id="listCredit"></div>	
	<h4><span class="glyphicon glyphicon-remove"></span> Expired Credits by Authorizer</h4> 
		<div id="listCreditEx"></div>	
	</div>
	</div>



</body>
</html>
