<html lang="en">
<head>
  <title>Administration</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
  <script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
  <script type="text/javascript" src="web3.js"></script>
  <script type="text/javascript" src="bignumber.js"></script>
  <script type="text/javascript" src="cc.js"></script>
  <script type="text/javascript">
	window.onload = function () {
	
		var claimedH = communityCurrency.ClaimH({}, function(error, result) {
			var row = "";
			claimedH.watch(function(error, result){
			row += Date(result.args._timeStamCH) + "&emsp;<b>" + result.args._servantC + "</b>&emsp;" + result.args._hFrom + "&emsp;<span class=\"badge\">" + result.args._claimedH/baseUnits + " HR</span><br/>";
			document.getElementById('listClaimedHours').innerHTML = row;
			});
		});

		var paidH = communityCurrency.PaidH({}, function(error, result) {
			var row = "";
			paidH.watch(function(error, result){
			row += Date(result.args._timeStampPH) + "&emsp;<b>" + result.args._servantP + "</b>&emsp;" + result.args._hTo  + "</b>&emsp;<span class=\"badge\">" + result.args.__paidH/baseUnits + " HR</span><br/>";
			document.getElementById('listPaidHours').innerHTML = row;
			});
		});
		
	document.getElementById('me').innerHTML = "alias: " + myAlias + "<br/> account: " + coinbase;
	document.getElementById('communeWallet').innerHTML = communeBalance/baseUnits + " HR";
	}
	
	var budget = communityCurrency.getBudget();
		var communeBalance = budget[8];
		
	function payHours() {
		var servant = document.getElementById('servant').value;
		var hours = document.getElementById('hours').value * baseUnits;
		communityCurrency.payHours(servant, hours)
		location.reload();
	}
	
	function payExpenses() {
		var contractor = document.getElementById('contractor').value;
		var expenses = document.getElementById('expenses').value * baseUnits;
		communityCurrency.payExpenses(contractor, expenses)
		location.reload();
	}	
  
	</script>
    <style>
    .navbar {
      margin-bottom: 0;
      border-radius: 0;
    }
  </style>
</head>
<body>

<nav class="navbar navbar-inverse">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#myNavbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span> 
      </button>
    <a class="navbar-brand" href="https://github.com/segovro/Community-Currency/wiki" target="blank"><span class="glyphicon glyphicon-hourglass"></span> Community Monetary System </a>
    </div>
    <div class="collapse navbar-collapse" id="myNavbar">
      <ul class="nav navbar-nav">
      <li><a href="index.html"><span class="glyphicon glyphicon-home"></span> Home</a></li>
      <li class="dropdown">
          <a class="dropdown-toggle" data-toggle="dropdown" href="payment.html.html"><span class="glyphicon glyphicon-transfer"></span> Transactions</a>
          <ul class="dropdown-menu">
          <li><a href="payment.html"><span class="glyphicon glyphicon-send"></span> Payment</a></li> 
          <li><a href="transactions.html"><span class="glyphicon glyphicon-transfer"></span> Transactions</a></li>        
          <li><a href="exchange.html"><span class="glyphicon glyphicon-random"></span> Exchange</a></li>        
          </ul>
        </li>
        <li class="dropdown">
          <a class="dropdown-toggle" data-toggle="dropdown" href="monitor.html"><span class="glyphicon glyphicon-thumbs-up"></span> P2P Credits</a>
          <ul class="dropdown-menu">
        <li><a href="endorseCredit.html"><span class="glyphicon glyphicon-ok"></span> Endorse P2P Credit</a></li> 
        <li><a href="access.html"><span class="glyphicon glyphicon-log-in"></span> Give access</a></li> 
        <li><a href="monitor.html"><span class="glyphicon glyphicon-eye-open"></span> Monitor account</a></li> 
          </ul>
        </li>
        <li class="dropdown">
          <a class="dropdown-toggle" data-toggle="dropdown" href="monitor.html"><span class="glyphicon glyphicon-user"></span> Commoner</a>
          <ul class="dropdown-menu">
          <li><a href="civilService.html"><span class="glyphicon glyphicon-hourglass"></span> Community Service</a></li>        
          <li><a href="funding.html"><span class="glyphicon glyphicon-cloud-upload"></span> Community Funding</a></li>        
          </ul>
        </li>
        <li class="dropdown">
          <a class="dropdown-toggle" data-toggle="dropdown" href="commune.html"><span class="glyphicon glyphicon-cloud"></span> Community</a>
          <ul class="dropdown-menu">
        <li><a href="commonersList.html"><span class="glyphicon glyphicon-user"></span> Commoners List</a></li> 
        <li><a href="budget.html"><span class="glyphicon glyphicon-th-list"></span> Commons Finances</a></li> 
        <li><a href="commune.html"><span class="glyphicon glyphicon-home"></span> Commune</a></li> 
        <li><a href="treasury.html"><span class="glyphicon glyphicon-lock"></span> Treasury</a></li>
        <li><a href="administration.html"><span class="glyphicon glyphicon-inbox"></span> Administration</a></li>
          </ul>
        </li>
      </ul>
    </div>
  </div>
</nav>
  
<div class="container bg-3 text-center"> 
      <small><p id="me"></p></small>   
<h3><span class="glyphicon glyphicon-inbox"></span> Administrative functions</h3>
		<div class="alert alert-warning">
			<small>This page only available to the Commune Account</small>
		</div>
   <div class="row">   

    <div class="col-sm-4">   
        <h3><span class="glyphicon glyphicon-hourglass"></span> Payment of Service Hours</h3>
		<form role="from" id="payData">
		  <div class="form-group">
		    <label for="servant">Servant account:</label>
		    <input type="text" class="form-control" id="servant" placeholder="Enter servant account">
		  </div>
		  <div class="form-group">
		    <label for="hours">Amount:</label>
		    <input type="text" class="form-control" id="hours" placeholder="Enter amount of hours">
		  </div>
    	</form>
			<button type="submit" class="btn btn-default" onClick="payHours();"><span class="glyphicon glyphicon-hourglass"></span> Pay Hours</button>
    
    <h3><span class="glyphicon glyphicon-hourglass"></span> Service hours</h4>
	<h4> Claimed</h4> 
		<div  id="listClaimedHours"></div>	
	<h4> Paid</h4> 
		<div id="listPaidHours"></div>	
	</div>

   <div class="col-sm-4">     

    <h3><span class="glyphicon glyphicon-cloud-download"></span> Community Expenses</h3>
		  
		<form role="form">		  
		  <div class="form-group">
		    <label for="contractor">Contractor account:</label>
		    <input type="text" class="form-control" id="contractor" placeholder="Enter contractor account">
		  </div>
		  <div class="form-group">
		    <label for="expenses">Expenses:</label>
		    <input type="text" class="form-control" id="expenses" placeholder="Enter amount in HR">
		  </div>
		 </form>
		    <button type="submit" class="btn btn-default" onClick="payExpenses();"><span class="glyphicon glyphicon-cloud-download"></span> Pay Expenses</button>

    </div>
    
    <div class="col-sm-4">   
        <h3><span class="glyphicon glyphicon-piggy-bank"></span> Commune Wallet</h3>
		<form role="from" id="payData">
		  <div class="form-group">
		    <label for="communeWallet">Commune Balance:</label>
		    <output class="form-control" id="communeWallet"></output>
		 </div>
    	</form>
  
    </div>
    	
  </div>
</div>

</body>
</html>
